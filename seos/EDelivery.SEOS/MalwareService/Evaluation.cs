using System;
using Newtonsoft.Json;
using Newtonsoft.Json.Converters;

namespace EDelivery.SEOS.MalwareService
{
    public class Evaluation
    {
        /// <summary>ID of the evaluation</summary>
        [JsonProperty("id")]
        public string Id { get; set; }

        /// <summary>Correlation ID</summary>
        [JsonProperty("correlationID")]
        public string CorrelationID { get; set; }

        /// <summary>Date/time the request for evaluation was made</summary>
        [JsonProperty("date")]
        public DateTime Date { get; set; }

        /// <summary>Elapsed time since the request for evaluation was made</summary>
        [JsonProperty("elapsedTime")]
        public TimeSpan? ElapsedTime { get; set; }

        /// <summary>Status</summary>
        [JsonProperty("status")]
        [JsonConverter(typeof(StringEnumConverter))]
        public EvaluationStatus Status { get; set; }

        /// <summary>Date/time of the status</summary>
        [JsonProperty("statusDate")]
        public DateTime StatusDate { get; set; }

        /// <summary>
        /// Flag indicating whether the evaluation identified a file as malicious or not.
        /// </summary>
        [JsonProperty("malicious")]
        public bool? Malicious { get; set; }

        /// <summary>Files</summary>
        [JsonProperty("files")]
        public EvaluationFile[] Files { get; set; }
    }
}
