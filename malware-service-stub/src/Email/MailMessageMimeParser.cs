// Copyright (c) 2009 snarum, (http://mimeparser.codeplex.com/)
// All rights reserved.
// Modified by Carlos Mendible
using System.IO;
using System.Net.Mail;
using System.Text;
using MimeKit;

namespace MalwareServiceStub
{
    public static class MailMessageMimeParser
    {
        public static MailMessage ParseMessage(string mimeMail)
        {
            using (var ms = new MemoryStream(UTF8Encoding.UTF8.GetBytes(mimeMail)))
            {
                var mimeMessage = MimeMessage.Load(ms);

                return mimeMessage.ConvertToMailMessage();
            }
        }

        public static MailMessage ParseMessage(StringReader mimeMail)
        {
            return ParseMessage(mimeMail.ReadToEnd());
        }
    }
}
