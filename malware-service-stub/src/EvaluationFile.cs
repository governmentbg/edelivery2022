using System;
using System.Text.Json.Serialization;

namespace MalwareServiceStub
{
    public record EvaluationFile
    {
        /// <summary>File name</summary>
        [JsonPropertyName("fileName")]
        public string? FileName { get; init; }

        /// <summary>SHA-256 hash of the file to evaluate</summary>
        [JsonPropertyName("sha256")]
        public string? Sha256 { get; init; }

        /// <summary>Status</summary>
        [JsonPropertyName("status")]
        [JsonConverter(typeof(JsonStringEnumConverter))]
        public EvaluationStatus Status { get; init; }

        /// <summary>Date/time of the status</summary>
        [JsonPropertyName("statusDate")]
        public DateTime StatusDate { get; init; }

        /// <summary>Flag indicating whether the evaluation identified this file malicious or not</summary>
        [JsonPropertyName("malicious")]
        public bool? Malicious { get; init; }

        /// <summary>Message</summary>
        [JsonPropertyName("message")]
        public string? Message { get; init; }
    }
}