using System;
using System.Text.Json.Serialization;

namespace ED.Blobs
{
    public record Evaluation
    {
        /// <summary>ID of the evaluation</summary>
        [JsonPropertyName("id")]
        public string? Id { get; init; }

        /// <summary>Correlation ID</summary>
        [JsonPropertyName("correlationID")]
        public string? CorrelationID { get; init; }

        /// <summary>Date/time the request for evaluation was made</summary>
        [JsonPropertyName("date")]
        public DateTime Date { get; init; }

        /// <summary>Elapsed time since the request for evaluation was made</summary>
        [JsonPropertyName("elapsedTime")]
        [JsonConverter(typeof(JsonTimeSpanConverter))]
        public TimeSpan? ElapsedTime { get; init; }

        /// <summary>Status</summary>
        [JsonPropertyName("status")]
        [JsonConverter(typeof(JsonStringEnumConverter))]
        public EvaluationStatus Status { get; init; }

        /// <summary>Date/time of the status</summary>
        [JsonPropertyName("statusDate")]
        public DateTime StatusDate { get; init; }

        /// <summary>
        /// Flag indicating whether the evaluation identified a file as malicious or not.
        /// </summary>
        [JsonPropertyName("malicious")]
        public bool? Malicious { get; init; }

        /// <summary>Files</summary>
        [JsonPropertyName("files")]
        public EvaluationFile[]? Files { get; init; }
    }
}
